- pipeline: "update production"
  trigger_mode: "ON_EVERY_PUSH"
  ref_name: "master"
  ref_type: "BRANCH"
  fetch_all_refs: true
  trigger_condition: "ALWAYS"
  target_site_url: "https://www.skillbill.it"
  actions:
  - action: "Execute: jekyll build"
    type: "BUILD"
    working_directory: "/srv/jekyll"
    docker_image_name: "jekyll/jekyll"
    docker_image_tag: "4.2.2"
    execute_commands:
    - echo `date`
    - "chown -R jekyll:jekyll $WORKING_DIR"
    - "bundle install"
    - "jekyll build"
    volume_mappings:
    - "/:/srv/jekyll"
    trigger_condition: "ALWAYS"
    shell: "BASH"
  - action: "Upload files"
    type: "SFTP"
    input_type: "BUILD_ARTIFACTS"
    local_path: "_site/"
    remote_path: "/var/www/html/"
    login: "root"
    host: "www.skillbill.it"
    port: "22"
    env_key: "prod_rsa"
    authentication_mode: "ENV_KEY"

